# üé¨ Filmorate

**Filmorate** ‚Äî —ç—Ç–æ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –∫–∏–Ω–æ. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Ñ–∏–ª—å–º—ã, –¥–æ–±–∞–≤–ª—è—Ç—å –∏—Ö –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ, –¥—Ä—É–∂–∏—Ç—å –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º,
 –∞ —Ç–∞–∫–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã –∏ –æ–±—â–∏—Ö –¥—Ä—É–∑–µ–π.

---

## üìä –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

![Filmorate DB Schema](./docs/filmorate-db-schema.png)

---

## üìù –ü–æ—è—Å–Ω–µ–Ω–∏–µ –∫ —Å—Ö–µ–º–µ

–°—Ö–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü:

| –¢–∞–±–ª–∏—Ü–∞        | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------|----------|
| `users`        | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–µ—Ä–≤–∏—Å–∞ |
| `films`        | –§–∏–ª—å–º—ã |
| `mpa_ratings`  | –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ (G, PG, R –∏ –¥—Ä.) |
| `genres`       | –ñ–∞–Ω—Ä—ã —Ñ–∏–ª—å–º–æ–≤ |
| `film_genres`  | –°–≤—è–∑—å —Ñ–∏–ª—å–º–æ–≤ –∏ –∂–∞–Ω—Ä–æ–≤ (–º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º) |
| `film_likes`   | –õ–∞–π–∫–∏ —Ñ–∏–ª—å–º–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `friendships`  | –î—Ä—É–∂–±–∞ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏ (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞/–Ω–µ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞) |

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã SQL-–∑–∞–ø—Ä–æ—Å–æ–≤
```sql
–¢–æ–ø-10 —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ª–∞–π–∫–æ–≤

SELECT f.id, f.name, COUNT(fl.user_id) AS likes
FROM films f
JOIN film_likes fl ON f.id = fl.film_id
GROUP BY f.id
ORDER BY likes DESC
LIMIT 10;

–ù–∞–π—Ç–∏ –æ–±—â–∏—Ö –¥—Ä—É–∑–µ–π –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

SELECT u.*
FROM friendships f1
JOIN friendships f2 ON f1.friend_id = f2.friend_id
JOIN users u ON u.id = f1.friend_id
WHERE f1.user_id = 1 AND f2.user_id = 2
  AND f1.status = 'CONFIRMED'
  AND f2.status = 'CONFIRMED';

  –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ñ–∏–ª—å–º—ã —Å –∂–∞–Ω—Ä–æ–º ¬´–î—Ä–∞–º–∞¬ª

SELECT f.*
FROM films f
JOIN film_genres fg ON f.id = fg.film_id
JOIN genres g ON fg.genre_id = g.id
WHERE g.name = '–î—Ä–∞–º–∞';

–§–∏–ª—å–º—ã —Å –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º PG-13

SELECT f.name, r.name AS rating
FROM films f
JOIN mpa_ratings r ON f.mpa_rating_id = r.id
WHERE r.name = 'PG-13';

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –¥—Ä—É–∑–µ–π

SELECT u.*
FROM users u
LEFT JOIN friendships f ON u.id = f.user_id
WHERE f.friend_id IS NULL;


